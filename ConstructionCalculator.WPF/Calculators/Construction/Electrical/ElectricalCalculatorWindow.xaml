<Window x:Class="ConstructionCalculator.WPF.Calculators.Construction.Electrical.ElectricalCalculatorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ConstructionCalculator.WPF.Calculators.Construction.Electrical"
        xmlns:help="clr-namespace:ConstructionCalculator.WPF.Shared.HelpSystem"
        Title="Electrical Load Calculator" Height="750" Width="700"
        ResizeMode="NoResize" WindowStartupLocation="CenterOwner"
        Icon="pack://application:,,,/Assets/app.ico"
        help:HelpBehavior.CalculatorKind="Electrical">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Calculate electrical panel load, circuit requirements, and wire sizing based on NEC 2023.&#x0a;Add circuits to determine total load, panel sizing, and per-circuit wire requirements." 
                   FontSize="12" FontStyle="Italic" Foreground="Gray" TextWrapping="Wrap" Margin="0,0,0,15"/>

        <GroupBox Grid.Row="1" Header="Add Circuit/Load" Padding="10" Margin="0,0,0,10">
            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <Label Content="Circuit Name:" Width="140" VerticalAlignment="Center" FontSize="13"/>
                    <TextBox x:Name="CircuitNameTextBox" Width="200" Height="28" FontSize="13" VerticalContentAlignment="Center"
                             ToolTip="Optional circuit name (e.g., 'Kitchen Receptacles', 'Living Room Lights')"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <Label Content="Circuit Type:" Width="140" VerticalAlignment="Center" FontSize="13"/>
                    <ComboBox x:Name="CircuitTypeComboBox" Width="200" Height="28" FontSize="13" SelectedIndex="0"
                              SelectionChanged="CircuitTypeComboBox_SelectionChanged">
                        <ComboBoxItem Content="General Lighting"/>
                        <ComboBoxItem Content="Small Appliance (Kitchen)"/>
                        <ComboBoxItem Content="Laundry"/>
                        <ComboBoxItem Content="Bathroom Receptacle"/>
                        <ComboBoxItem Content="General Receptacle"/>
                        <ComboBoxItem Content="Electric Range/Oven"/>
                        <ComboBoxItem Content="Electric Dryer"/>
                        <ComboBoxItem Content="Dishwasher"/>
                        <ComboBoxItem Content="Garbage Disposal"/>
                        <ComboBoxItem Content="Microwave"/>
                        <ComboBoxItem Content="Refrigerator"/>
                        <ComboBoxItem Content="Water Heater"/>
                        <ComboBoxItem Content="HVAC (Heating)"/>
                        <ComboBoxItem Content="HVAC (Cooling/AC)"/>
                        <ComboBoxItem Content="Heat Pump"/>
                        <ComboBoxItem Content="EV Charger (EVSE)"/>
                        <ComboBoxItem Content="Pool/Spa Equipment"/>
                        <ComboBoxItem Content="Custom Appliance"/>
                    </ComboBox>
                </StackPanel>
                
                <!-- Dynamic input based on circuit type -->
                <StackPanel x:Name="LightingInputPanel" Visibility="Visible">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <Label Content="Square Footage:" Width="140" VerticalAlignment="Center" FontSize="13"/>
                        <TextBox x:Name="SquareFootageTextBox" Width="100" Height="28" FontSize="13" VerticalContentAlignment="Center"
                                 ToolTip="Total square footage for lighting calculation (NEC: 3 VA per sq ft)"/>
                        <Label Content="sq ft" Width="50" VerticalAlignment="Center" FontSize="13" Margin="5,0,0,0"/>
                    </StackPanel>
                </StackPanel>
                
                <StackPanel x:Name="ApplianceInputPanel" Visibility="Collapsed">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <Label Content="Voltage:" Width="140" VerticalAlignment="Center" FontSize="13"/>
                        <ComboBox x:Name="VoltageComboBox" Width="100" Height="28" FontSize="13" SelectedIndex="0">
                            <ComboBoxItem Content="120V"/>
                            <ComboBoxItem Content="240V"/>
                        </ComboBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <Label Content="Load (Watts or VA):" Width="140" VerticalAlignment="Center" FontSize="13"/>
                        <TextBox x:Name="LoadWattsTextBox" Width="100" Height="28" FontSize="13" VerticalContentAlignment="Center"
                                 ToolTip="Appliance nameplate rating in watts or VA"/>
                        <Label Content="W/VA" Width="50" VerticalAlignment="Center" FontSize="13" Margin="5,0,0,0"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel x:Name="CountInputPanel" Visibility="Collapsed">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <Label Content="Number of Circuits:" Width="140" VerticalAlignment="Center" FontSize="13"/>
                        <TextBox x:Name="CircuitCountTextBox" Width="100" Height="28" FontSize="13" VerticalContentAlignment="Center"
                                 Text="2" ToolTip="Number of circuits (e.g., 2 small appliance circuits required)"/>
                    </StackPanel>
                </StackPanel>

                <Button Content="Add Circuit" 
                        Style="{StaticResource PrimaryActionButtonStyle}"
                        Height="32" Click="AddCircuitButton_Click"/>
            </StackPanel>
        </GroupBox>

        <GroupBox Grid.Row="2" Header="Circuits" Padding="10" Margin="0,0,0,10">
            <StackPanel>
                <ListBox x:Name="CircuitsListBox" Height="150" FontSize="12" Margin="0,0,0,8"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button Content="Remove Selected Circuit" 
                            Style="{StaticResource ActionButtonStyle}"
                            Width="180" Height="28" Margin="0,0,5,0" Click="RemoveCircuitButton_Click"/>
                    <Button Content="Clear All Circuits" 
                            Style="{StaticResource ActionButtonStyle}"
                            Width="140" Height="28" Margin="5,0,0,0" Click="ClearAllCircuitsButton_Click"/>
                </StackPanel>
            </StackPanel>
        </GroupBox>

        <Border Grid.Row="3" BorderBrush="Gray" BorderThickness="2" Padding="15" Background="#F5F5F5" Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="Panel Load Summary:" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                <TextBlock x:Name="TotalConnectedLoadLabel" Text="Total Connected Load: 0 VA" 
                           FontSize="13" Margin="0,0,0,5"/>
                <TextBlock x:Name="DemandLoadLabel" Text="Demand Load (with NEC factors): 0 VA" 
                           FontSize="14" FontWeight="SemiBold" Margin="0,5,0,5" Foreground="DarkBlue"/>
                <TextBlock x:Name="RequiredAmpsLabel" Text="Required Amperage: 0 A" 
                           FontSize="14" FontWeight="SemiBold" Margin="0,0,0,5" Foreground="DarkRed"/>
                <TextBlock x:Name="RecommendedPanelLabel" Text="Recommended Panel: Not calculated" 
                           FontSize="14" FontWeight="Bold" Margin="0,5,0,5" Foreground="DarkGreen"/>
                <TextBlock x:Name="MainBreakerLabel" Text="Main Breaker Size: Not calculated" 
                           FontSize="13" Margin="0,5,0,0"/>
                
                <Separator Margin="0,10,0,10"/>
                
                <TextBlock Text="NEC Demand Factors Applied:" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,5"/>
                <TextBlock x:Name="DemandFactorsLabel" Text="No circuits added yet" 
                           FontSize="11" FontStyle="Italic" Foreground="Gray" TextWrapping="Wrap"/>
            </StackPanel>
        </Border>

        <GroupBox Grid.Row="4" Header="Wire Sizing for Individual Circuit" Padding="10" Margin="0,0,0,10">
            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <Label Content="Circuit Load:" Width="140" VerticalAlignment="Center" FontSize="13"/>
                    <TextBox x:Name="WireSizingLoadTextBox" Width="100" Height="28" FontSize="13" VerticalContentAlignment="Center"
                             ToolTip="Circuit load in watts or amps"/>
                    <ComboBox x:Name="WireSizingUnitComboBox" Width="80" Height="28" FontSize="13" Margin="5,0,0,0" SelectedIndex="0">
                        <ComboBoxItem Content="Watts"/>
                        <ComboBoxItem Content="Amps"/>
                    </ComboBox>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <Label Content="Voltage:" Width="140" VerticalAlignment="Center" FontSize="13"/>
                    <ComboBox x:Name="WireSizingVoltageComboBox" Width="100" Height="28" FontSize="13" SelectedIndex="0">
                        <ComboBoxItem Content="120V"/>
                        <ComboBoxItem Content="240V"/>
                    </ComboBox>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <Label Content="Wire Length (one-way):" Width="140" VerticalAlignment="Center" FontSize="13"/>
                    <TextBox x:Name="WireLengthTextBox" Width="100" Height="28" FontSize="13" VerticalContentAlignment="Center"
                             Text="50" ToolTip="One-way wire run length in feet"/>
                    <Label Content="ft" Width="30" VerticalAlignment="Center" FontSize="13" Margin="5,0,0,0"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <Label Content="Wire Type:" Width="140" VerticalAlignment="Center" FontSize="13"/>
                    <ComboBox x:Name="WireTypeComboBox" Width="150" Height="28" FontSize="13" SelectedIndex="0">
                        <ComboBoxItem Content="Copper"/>
                        <ComboBoxItem Content="Aluminum"/>
                    </ComboBox>
                </StackPanel>
                <Button Content="Calculate Wire Size" 
                        Style="{StaticResource ActionButtonStyle}"
                        Height="30" Click="CalculateWireSizeButton_Click"/>
                <TextBlock x:Name="WireSizeResultLabel" Text="Wire Size: Not calculated" 
                           FontSize="13" FontWeight="SemiBold" Margin="0,10,0,0"/>
                <TextBlock x:Name="BreakerSizeResultLabel" Text="Breaker Size: Not calculated" 
                           FontSize="13" Margin="0,5,0,0"/>
                <TextBlock x:Name="VoltageDropLabel" Text="Voltage Drop: Not calculated" 
                           FontSize="12" FontStyle="Italic" Foreground="Gray" Margin="0,5,0,0"/>
            </StackPanel>
        </GroupBox>

        <Button Grid.Row="5" Content="Copy Results" 
                Style="{StaticResource ActionButtonStyle}"
                Height="32" Margin="0,0,0,10" Click="CopyResultsButton_Click"/>

        <TextBlock Grid.Row="6" Text="Note: Calculations based on NEC 2023. Always consult with a licensed electrician and local codes for final design and installation." 
                   FontSize="11" FontStyle="Italic" Foreground="Gray" TextWrapping="Wrap"/>
        </Grid>
    </ScrollViewer>
</Window>
