<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ConstructionCalculatorMAUI.Pages.MainPage"
             Title="Construction Calculator">

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Help" Clicked="OnHelpClicked" />
    </ContentPage.ToolbarItems>

    <!-- 
    Main Calculator Page
    Provides feet-inches-fractions arithmetic with decimal mode toggle.
    Supports calculation chains and keyboard shortcuts.
    -->

    <ScrollView>
        <VerticalStackLayout Padding="15" Spacing="10">
            
            <!-- Mode Display -->
            <Label x:Name="ModeLabel"
                   Text="Mode: Fractions (1/16&quot;)"
                   FontSize="14"
                   HorizontalOptions="Start" />

            <!-- Calculation Chain Display -->
            <Label x:Name="ChainLabel"
                   Text=""
                   FontSize="12"
                   HorizontalOptions="End"
                   MinimumHeightRequest="30" />

            <!-- Memory Indicator -->
            <Label x:Name="MemoryLabel"
                   Text=""
                   FontSize="11"
                   FontAttributes="Bold"
                   TextColor="{AppThemeBinding Light=#00CED1, Dark=#00CED1}"
                   HorizontalOptions="End"
                   IsVisible="False"
                   MinimumHeightRequest="20" />

            <!-- Display Entry -->
            <Entry x:Name="DisplayEntry"
                   Text="0&quot;"
                   FontSize="24"
                   FontFamily="Courier"
                   FontAttributes="Bold"
                   HorizontalTextAlignment="End"
                   IsReadOnly="True"
                   Keyboard="Text"
                   Completed="OnDisplayCompleted"
                   Focused="OnDisplayFocused"
                   HeightRequest="55" />

            <!-- Calculator Buttons Grid -->
            <Grid RowDefinitions="50,50,50,50,50,50,50"
                  ColumnDefinitions="*,*,*,*,*"
                  RowSpacing="6"
                  ColumnSpacing="10"
                  Margin="0,15,0,0">

                <!-- Row 0: 7, 8, 9, ÷, MC -->
                <Button Text="7" Grid.Row="0" Grid.Column="0" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
                <Button Text="8" Grid.Row="0" Grid.Column="1" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
                <Button Text="9" Grid.Row="0" Grid.Column="2" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
                <Button Text="÷" Grid.Row="0" Grid.Column="3" Clicked="OnOperatorClicked" CommandParameter="/" Style="{StaticResource OperatorButton}" />
                <Button Text="MC" Grid.Row="0" Grid.Column="4" Clicked="OnMemoryClicked" Style="{StaticResource ActionButton}" />

                <!-- Row 1: 4, 5, 6, ×, MR -->
                <Button Text="4" Grid.Row="1" Grid.Column="0" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
                <Button Text="5" Grid.Row="1" Grid.Column="1" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
                <Button Text="6" Grid.Row="1" Grid.Column="2" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
                <Button Text="×" Grid.Row="1" Grid.Column="3" Clicked="OnOperatorClicked" CommandParameter="*" Style="{StaticResource OperatorButton}" />
                <Button Text="MR" Grid.Row="1" Grid.Column="4" Clicked="OnMemoryClicked" Style="{StaticResource ActionButton}" />

                <!-- Row 2: 1, 2, 3, -, M+ -->
                <Button Text="1" Grid.Row="2" Grid.Column="0" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
                <Button Text="2" Grid.Row="2" Grid.Column="1" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
                <Button Text="3" Grid.Row="2" Grid.Column="2" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
                <Button Text="-" Grid.Row="2" Grid.Column="3" Clicked="OnOperatorClicked" Style="{StaticResource OperatorButton}" />
                <Button Text="M+" Grid.Row="2" Grid.Column="4" Clicked="OnMemoryClicked" Style="{StaticResource ActionButton}" />

                <!-- Row 3: 0, ', ", +, M- -->
                <Button Text="0" Grid.Row="3" Grid.Column="0" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
                <Button Text="'" Grid.Row="3" Grid.Column="1" Clicked="OnNumberClicked" />
                <Button Text="&quot;" Grid.Row="3" Grid.Column="2" Clicked="OnNumberClicked" />
                <Button Text="+" Grid.Row="3" Grid.Column="3" Clicked="OnOperatorClicked" Style="{StaticResource OperatorButton}" />
                <Button Text="M-" Grid.Row="3" Grid.Column="4" Clicked="OnMemoryClicked" Style="{StaticResource ActionButton}" />

                <!-- Row 4: Space, /, ., =, (empty) -->
                <Button Text="Space" Grid.Row="4" Grid.Column="0" Clicked="OnSpaceClicked" />
                <Button Text="/" Grid.Row="4" Grid.Column="1" Clicked="OnNumberClicked" />
                <Button Text="." Grid.Row="4" Grid.Column="2" Clicked="OnNumberClicked" />
                <Button Text="=" Grid.Row="4" Grid.Column="3" Clicked="OnEqualsClicked" Style="{StaticResource OperatorButton}" />

                <!-- Row 5: %, √, x², +/-, (empty) -->
                <Button Text="%" Grid.Row="5" Grid.Column="0" Clicked="OnMathFunctionClicked" Style="{StaticResource OperatorButton}" />
                <Button Text="√" Grid.Row="5" Grid.Column="1" Clicked="OnMathFunctionClicked" Style="{StaticResource OperatorButton}" />
                <Button Text="x²" Grid.Row="5" Grid.Column="2" Clicked="OnMathFunctionClicked" Style="{StaticResource OperatorButton}" />
                <Button Text="+/-" Grid.Row="5" Grid.Column="3" Clicked="OnMathFunctionClicked" Style="{StaticResource OperatorButton}" />

                <!-- Row 6: C, CE, Copy, Mode, (empty) -->
                <Button Text="C" Grid.Row="6" Grid.Column="0" Clicked="OnClearClicked" Style="{StaticResource ActionButton}" />
                <Button Text="CE" Grid.Row="6" Grid.Column="1" Clicked="OnClearEntryClicked" Style="{StaticResource ActionButton}" />
                <Button Text="Copy" Grid.Row="6" Grid.Column="2" Clicked="OnCopyClicked" Style="{StaticResource ActionButton}" />
                <Button Text="Mode" Grid.Row="6" Grid.Column="3" Clicked="OnModeClicked" Style="{StaticResource ActionButton}" />
            </Grid>

            <!-- Instructions -->
            <Label FontSize="10"
                   Margin="0,20,0,0">
                <Label.FormattedText>
                    <FormattedString>
                        <Span Text="Enter measurements: 23' 6 1/2&quot; or 6 1/2&quot; or 1/2&quot;&#x0a;" />
                        <Span Text="Tap = to calculate, C to clear, CE to undo last entry&#x0a;" />
                        <Span Text="Mode toggles between fractions and decimal inches" />
                    </FormattedString>
                </Label.FormattedText>
            </Label>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
