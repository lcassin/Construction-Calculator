<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:ConstructionCalculatorMAUI.Models"
             x:Class="ConstructionCalculatorMAUI.Pages.CalculatorHubPage"
             Title="Calculators">

    <!-- 
    Calculator Hub Page - Tile-based layout
    Provides grouped navigation to all calculators with icons and help buttons,
    matching the WPF Calculator Launcher design.
    -->

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">
            
            <!-- Header -->
            <Label Text="Construction Calculators"
                   FontSize="28"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   Margin="0,10,0,10" />

            <!-- Instructions -->
            <VerticalStackLayout Spacing="5" Margin="0,0,0,10">
                <Label Text="Select a calculator to open:"
                       FontSize="14"
                       TextColor="{AppThemeBinding Light=#666666, Dark=#AAAAAA}"
                       HorizontalOptions="Start" />
                <Label Text="Tap the ? button for context help"
                       FontSize="12"
                       TextColor="{AppThemeBinding Light=#0078D4, Dark=#64B5F6}"
                       FontAttributes="Bold"
                       HorizontalOptions="Start" />
            </VerticalStackLayout>

            <!-- Calculator Tiles in Grid Layout -->
            <CollectionView ItemsSource="{Binding Calculators}"
                           SelectionMode="None">
                <CollectionView.ItemsLayout>
                    <GridItemsLayout Orientation="Vertical"
                                    Span="2"
                                    HorizontalItemSpacing="10"
                                    VerticalItemSpacing="10" />
                </CollectionView.ItemsLayout>
                
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:CalculatorDescriptor">
                        <Grid>
                            <!-- Main Tile Border -->
                            <Border BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2A2A2A}"
                                   StrokeThickness="1"
                                   Stroke="{AppThemeBinding Light=#E0E0E0, Dark=#404040}"
                                   Padding="15"
                                   MinimumHeightRequest="140">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="8" />
                                </Border.StrokeShape>
                                
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="OnCalculatorTileTapped" />
                                </Border.GestureRecognizers>
                                
                                <Grid RowSpacing="8">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Category Badge -->
                                    <Border Grid.Row="0"
                                           BackgroundColor="{AppThemeBinding Light=#E0E0E0, Dark=#404040}"
                                           Padding="6,3"
                                           HorizontalOptions="Start">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="3" />
                                        </Border.StrokeShape>
                                        <Label Text="{Binding Category}"
                                              FontSize="10"
                                              TextColor="{AppThemeBinding Light=#606060, Dark=#B0B0B0}" />
                                    </Border>

                                    <!-- Icon and Name Row -->
                                    <Grid Grid.Row="1" ColumnSpacing="10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Icon -->
                                        <Label Grid.Column="0"
                                              Text="{Binding Icon}"
                                              FontFamily="{Binding IconFontFamily}"
                                              FontSize="24"
                                              VerticalOptions="Center"
                                              TextColor="{AppThemeBinding Light=#000000, Dark=#FFFFFF}" />
                                        
                                        <!-- Calculator Name -->
                                        <Label Grid.Column="1"
                                              Text="{Binding Name}"
                                              FontSize="16"
                                              FontAttributes="Bold"
                                              LineBreakMode="WordWrap"
                                              VerticalOptions="Center"
                                              TextColor="{AppThemeBinding Light=#000000, Dark=#FFFFFF}" />
                                    </Grid>

                                    <!-- Description -->
                                    <Label Grid.Row="2"
                                          Text="{Binding Description}"
                                          FontSize="12"
                                          TextColor="{AppThemeBinding Light=#666666, Dark=#AAAAAA}"
                                          LineBreakMode="WordWrap"
                                          MaxLines="3"
                                          VerticalOptions="Start" />
                                </Grid>
                            </Border>
                            
                            <!-- Help Button Overlay (Top-Right Corner) -->
                            <Button Text="?"
                                   WidthRequest="32"
                                   HeightRequest="32"
                                   CornerRadius="16"
                                   FontSize="16"
                                   FontAttributes="Bold"
                                   BackgroundColor="#0078D4"
                                   TextColor="White"
                                   BorderWidth="0"
                                   Padding="0"
                                   HorizontalOptions="End"
                                   VerticalOptions="Start"
                                   Margin="8"
                                   Clicked="OnHelpButtonClicked"
                                   ZIndex="100">
                                <Button.Shadow>
                                    <Shadow Brush="Black"
                                           Opacity="0.3"
                                           Radius="4"
                                           Offset="2,2" />
                                </Button.Shadow>
                            </Button>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
